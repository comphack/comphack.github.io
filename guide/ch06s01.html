<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Channel Server</title><link rel="stylesheet" type="text/css" href="static/docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="index.html" title="COMP_hack: The Definitive Guide" /><link rel="up" href="ch06.html" title="Chapter 6. Network Protocols" /><link rel="prev" href="ch06.html" title="Chapter 6. Network Protocols" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Channel Server</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch06.html">Prev</a> </td><th width="60%" align="center">Chapter 6. Network Protocols</th><td width="20%" align="right"> </td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idm45138062448320"></a>Channel Server</h2></div></div></div><p>Commands between the client and channel server.</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm45138062449344"></a>CS_Challenge</h3></div></div></div><div class="table"><a id="idm45138065757872"></a><p class="title"><strong>Table 6.1. Command Information</strong></p><div class="table-contents"><table class="table" summary="Command Information" border="1"><colgroup><col /><col /></colgroup><tbody><tr><td align="left">Name</td><td align="left">CS_Challenge</td></tr><tr><td align="left">Command Code</td><td align="left">0x0000</td></tr><tr><td align="left">Direction</td><td align="left">Client =&gt; Server</td></tr></tbody></table></div></div><br class="table-break" /><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45138065757616"></a>Description</h4></div></div></div><p>Provides the server with login information. There are two forms to this command. The classical form was used before the web driven authentication was implemented. It contains a user name followed by a session key (used to salt the password). The modern form contains an authentication token, session key, and user name. The classical form is followed by a CS_CheckPassword; however, the modern form skips this step (the credentials were authenticated by the web page and the token was then provided).</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45138065759072"></a>Specification (Classic)</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>u32 sessionKey - The session key. A random value to use as a password salt.</p></li><li class="listitem"><p>string16 userName - User name for the client who wishes to connect.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45138065764064"></a>Specification (Modern)</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>string16 authToken - Authentication token provided by the web page or previous channel to login.</p></li><li class="listitem"><p>u32 sessionKey - The session key. A random value to use as a password salt.</p></li><li class="listitem"><p>string16 userName - User name for the client who wishes to connect.</p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm45138065763808"></a>SC_Send_DeleteObject</h3></div></div></div><div class="table"><a id="idm45138065765856"></a><p class="title"><strong>Table 6.2. Command Information</strong></p><div class="table-contents"><table class="table" summary="Command Information" border="1"><colgroup><col /><col /></colgroup><tbody><tr><td align="left">Name</td><td align="left">SC_Send_DeleteObject</td></tr><tr><td align="left">Command Code</td><td align="left">0x0018</td></tr><tr><td align="left">Direction</td><td align="left">Server =&gt; Client</td></tr></tbody></table></div></div><br class="table-break" /><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45138065769632"></a>Description</h4></div></div></div><p>Notifies the client that an object in the world has been deleted. Examples of objects: player, partner, enemy, NPC, gimmick, gift box.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45138065771200"></a>Specification</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>u32 objectUID - Unique ID for the object to delete.</p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm45138059542048"></a>SC_Send_ZoneChange</h3></div></div></div><div class="table"><a id="idm45138059539344"></a><p class="title"><strong>Table 6.3. Command Information</strong></p><div class="table-contents"><table class="table" summary="Command Information" border="1"><colgroup><col /><col /></colgroup><tbody><tr><td align="left">Name</td><td align="left">SC_Send_ZoneChange</td></tr><tr><td align="left">Command Code</td><td align="left">0x0023</td></tr><tr><td align="left">Direction</td><td align="left">Server =&gt; Client</td></tr></tbody></table></div></div><br class="table-break" /><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45138059544720"></a>Description</h4></div></div></div><p>Instructs the client to move the player to a new zone. This could be the same zone with a different location. Regardless, the client will clear out all objects and start again from the assumption there are none. The server must then provide the client with object population information (which NPCs, PCs, enemies, etc. are nearby).</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45138059545776"></a>Specification</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>u32 zoneID - ID for the zone to load. This value corresponds to an entry in the ZoneData file (in BinaryData/Shield).</p></li><li class="listitem"><p>u32 zoneSet - This ID appears to be for a set of related zones. It is uncertain what else the ID may be used for.</p></li><li class="listitem"><p>f32 positionX - X-axis coordinate of the player.</p></li><li class="listitem"><p>f32 positionY - Y-axis coordinate of the player.</p></li><li class="listitem"><p>f32 orientation - Rotation of the player (in radians).</p></li><li class="listitem"><p>u32 dynamicID - ID for the zone that corresponds to an entry in the DynamicMapData file (in BinaryData/Client). The DynamicMapData entry contains filenames for data that may change for different usages of the same zone. This can include NPC population information (that is server only and re-implemented in a custom format) and SpotData.</p></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idm45138056249744"></a>CS_Send_PlayerReport</h3></div></div></div><div class="table"><a id="idm45138056251792"></a><p class="title"><strong>Table 6.4. Command Information</strong></p><div class="table-contents"><table class="table" summary="Command Information" border="1"><colgroup><col /><col /></colgroup><tbody><tr><td align="left">Name</td><td align="left">CS_Send_PlayerReport</td></tr><tr><td align="left">Command Code</td><td align="left">0x0407</td></tr><tr><td align="left">Direction</td><td align="left">Server &lt;= Client</td></tr></tbody></table></div></div><br class="table-break" /><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45138065683584"></a>Description</h4></div></div></div><p>Sends a player bad behavior report to the game masters.</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idm45138065683456"></a>Specification</h4></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>u32 reportID - ID for the report being filed. This starts at 0 and increments by 1 for each new report. Used to check that the report was submitted successfully.</p></li><li class="listitem"><p>u8 reportType - Report type. The possible values are as follows:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>0: 指定なし - Not Specified</p></li><li class="listitem"><p>1: チャットによる迷惑行為 - Chat Abuse</p></li><li class="listitem"><p>2: 誹議中傷行為 - Slander</p></li><li class="listitem"><p>3: ゲーム進行妨害行為 - Preventing from Proceeding with the Game</p></li><li class="listitem"><p>4: 詐欺行為 - Fraud</p></li><li class="listitem"><p>5: 不正ツール利用 - Use of Illegal Tools</p></li><li class="listitem"><p>6: リアルマネートレード行為 - RMT</p></li><li class="listitem"><p>7: その他の迷惑行為 - Other</p></li></ul></div></li><li class="listitem"><p>string16 playerName - Name of the player being reported.</p></li><li class="listitem"><p>string16 worldName - Name of the world the problem arose on.</p></li><li class="listitem"><p>string16 message - Message describing the problem. A maximum of 200 characters is allowed.</p></li></ul></div></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch06.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch06.html">Up</a></td><td width="40%" align="right"> </td></tr><tr><td width="40%" align="left" valign="top">Chapter 6. Network Protocols </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>